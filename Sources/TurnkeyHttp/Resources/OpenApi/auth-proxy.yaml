openapi: 3.0.1
info:
  title: services/auth_proxy/v1/proxy_api.proto
  version: version not set
servers:
- url: /
paths:
  /v1/account:
    post:
      tags:
      - Accounts
      summary: Get Account
      description: "Return organization id associated with a given phone number, email,\
        \ public key, credential ID or OIDC token."
      operationId: GetAccount
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetAccountRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetAccountResponse'
      x-codegen-request-body-name: body
  /v1/oauth2_authenticate:
    post:
      tags:
      - Auth
      summary: OAuth 2.0 Authenticate
      description: Authenticate with an OAuth 2.0 provider and receive an OIDC token
        issued by Turnkey in response.
      operationId: OAuth2Authenticate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuth2AuthenticateRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2AuthenticateResponse'
      x-codegen-request-body-name: body
  /v1/oauth_login:
    post:
      tags:
      - Sessions
      summary: OAuth Login
      description: Login using an OIDC token and public key.
      operationId: OAuthLogin
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthLoginRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthLoginResponse'
      x-codegen-request-body-name: body
  /v1/otp_init:
    post:
      tags:
      - Auth
      summary: Init OTP
      description: Initialize an OTP (email or SMS) for a user.
      operationId: InitOtp
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitOtpRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitOtpResponse'
      x-codegen-request-body-name: body
  /v1/otp_login:
    post:
      tags:
      - Sessions
      summary: OTP Login
      description: Login using a verification token and public key.
      operationId: OtpLogin
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OtpLoginRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OtpLoginResponse'
      x-codegen-request-body-name: body
  /v1/otp_verify:
    post:
      tags:
      - Auth
      summary: Verify OTP
      description: Verify the OTP code previously sent to the user's contact and return
        a verification token.
      operationId: VerifyOtp
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerifyOtpRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerifyOtpResponse'
      x-codegen-request-body-name: body
  /v1/signup:
    post:
      tags:
      - Auth
      summary: Signup
      description: Onboard a new user.
      operationId: Signup
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignupRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SignupResponse'
      x-codegen-request-body-name: body
  /v1/wallet_kit_config:
    post:
      tags:
      - Wallet Kit
      summary: Get WalletKit Config
      description: Get wallet kit settings and feature toggles for the calling organization.
      operationId: GetWalletKitConfig
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GetWalletKitConfigRequest'
        required: true
      responses:
        "200":
          description: A successful response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetWalletKitConfigResponse'
      x-codegen-request-body-name: body
components:
  schemas:
    AddressFormat:
      type: string
      enum:
      - ADDRESS_FORMAT_UNCOMPRESSED
      - ADDRESS_FORMAT_COMPRESSED
      - ADDRESS_FORMAT_ETHEREUM
      - ADDRESS_FORMAT_SOLANA
      - ADDRESS_FORMAT_COSMOS
      - ADDRESS_FORMAT_TRON
      - ADDRESS_FORMAT_SUI
      - ADDRESS_FORMAT_APTOS
      - ADDRESS_FORMAT_BITCOIN_MAINNET_P2PKH
      - ADDRESS_FORMAT_BITCOIN_MAINNET_P2SH
      - ADDRESS_FORMAT_BITCOIN_MAINNET_P2WPKH
      - ADDRESS_FORMAT_BITCOIN_MAINNET_P2WSH
      - ADDRESS_FORMAT_BITCOIN_MAINNET_P2TR
      - ADDRESS_FORMAT_BITCOIN_TESTNET_P2PKH
      - ADDRESS_FORMAT_BITCOIN_TESTNET_P2SH
      - ADDRESS_FORMAT_BITCOIN_TESTNET_P2WPKH
      - ADDRESS_FORMAT_BITCOIN_TESTNET_P2WSH
      - ADDRESS_FORMAT_BITCOIN_TESTNET_P2TR
      - ADDRESS_FORMAT_BITCOIN_SIGNET_P2PKH
      - ADDRESS_FORMAT_BITCOIN_SIGNET_P2SH
      - ADDRESS_FORMAT_BITCOIN_SIGNET_P2WPKH
      - ADDRESS_FORMAT_BITCOIN_SIGNET_P2WSH
      - ADDRESS_FORMAT_BITCOIN_SIGNET_P2TR
      - ADDRESS_FORMAT_BITCOIN_REGTEST_P2PKH
      - ADDRESS_FORMAT_BITCOIN_REGTEST_P2SH
      - ADDRESS_FORMAT_BITCOIN_REGTEST_P2WPKH
      - ADDRESS_FORMAT_BITCOIN_REGTEST_P2WSH
      - ADDRESS_FORMAT_BITCOIN_REGTEST_P2TR
      - ADDRESS_FORMAT_SEI
      - ADDRESS_FORMAT_XLM
      - ADDRESS_FORMAT_DOGE_MAINNET
      - ADDRESS_FORMAT_DOGE_TESTNET
      - ADDRESS_FORMAT_TON_V3R2
      - ADDRESS_FORMAT_TON_V4R2
      - ADDRESS_FORMAT_TON_V5R1
      - ADDRESS_FORMAT_XRP
    ApiKeyCurve:
      type: string
      enum:
      - API_KEY_CURVE_P256
      - API_KEY_CURVE_SECP256K1
      - API_KEY_CURVE_ED25519
    ApiKeyParamsV2:
      required:
      - apiKeyName
      - curveType
      - publicKey
      type: object
      properties:
        apiKeyName:
          type: string
          description: Human-readable name for an API Key.
        publicKey:
          type: string
          description: The public component of a cryptographic key pair used to sign
            messages and transactions.
        curveType:
          $ref: '#/components/schemas/ApiKeyCurve'
        expirationSeconds:
          type: string
          description: Optional window (in seconds) indicating how long the API Key
            should last.
          nullable: true
    Attestation:
      required:
      - attestationObject
      - clientDataJson
      - credentialId
      - transports
      type: object
      properties:
        credentialId:
          type: string
          description: The cbor encoded then base64 url encoded id of the credential.
        clientDataJson:
          type: string
          description: A base64 url encoded payload containing metadata about the
            signing context and the challenge.
        attestationObject:
          type: string
          description: A base64 url encoded payload containing authenticator data
            and any attestation the webauthn provider chooses.
        transports:
          type: array
          description: The type of authenticator transports.
          items:
            $ref: '#/components/schemas/AuthenticatorTransport'
    AuthenticatorParamsV2:
      required:
      - attestation
      - authenticatorName
      - challenge
      type: object
      properties:
        authenticatorName:
          type: string
          description: Human-readable name for an Authenticator.
        challenge:
          type: string
          description: Challenge presented for authentication purposes.
        attestation:
          $ref: '#/components/schemas/Attestation'
    AuthenticatorTransport:
      type: string
      enum:
      - AUTHENTICATOR_TRANSPORT_BLE
      - AUTHENTICATOR_TRANSPORT_INTERNAL
      - AUTHENTICATOR_TRANSPORT_NFC
      - AUTHENTICATOR_TRANSPORT_USB
      - AUTHENTICATOR_TRANSPORT_HYBRID
    Curve:
      type: string
      enum:
      - CURVE_SECP256K1
      - CURVE_ED25519
    GetAccountRequest:
      required:
      - filterType
      - filterValue
      type: object
      properties:
        filterType:
          type: string
          description: "Specifies the type of filter to apply, i.e 'CREDENTIAL_ID',\
            \ 'NAME', 'USERNAME', 'EMAIL', 'PHONE_NUMBER', 'OIDC_TOKEN' or 'PUBLIC_KEY'"
        filterValue:
          type: string
          description: "The value of the filter to apply for the specified type. For\
            \ example, a specific email or name string."
        verificationToken:
          type: string
          description: "Signed JWT containing a unique id, expiry, verification type,\
            \ contact. Used to verify access to PII (email/phone number) when filter_type\
            \ is 'EMAIL' or 'PHONE_NUMBER'."
          nullable: true
    GetAccountResponse:
      type: object
      properties:
        organizationId:
          type: string
          nullable: true
    GetWalletKitConfigRequest:
      type: object
    GetWalletKitConfigResponse:
      required:
      - enabledProviders
      - organizationId
      - sessionExpirationSeconds
      type: object
      properties:
        enabledProviders:
          title: Enabled Providers
          type: array
          description: "List of enabled authentication providers (e.g., 'facebook',\
            \ 'google', 'apple', 'email', 'sms', 'passkey', 'wallet')"
          items:
            type: string
        sessionExpirationSeconds:
          title: Session Expiration
          type: string
          description: Session expiration duration in seconds
        organizationId:
          title: Organization ID
          type: string
          description: The organization ID this configuration applies to
        oauthClientIds:
          title: OAuth Client IDs
          type: object
          additionalProperties:
            type: string
          description: Mapping of social login providers to their OAuth client IDs.
        oauthRedirectUrl:
          title: OAuth Redirect URL
          type: string
          description: OAuth redirect URL to be used for social login flows.
        otpAlphanumeric:
          type: boolean
          nullable: true
        otpLength:
          type: string
          nullable: true
    InitOtpRequest:
      required:
      - contact
      - otpType
      type: object
      properties:
        otpType:
          type: string
          description: Enum to specifiy whether to send OTP via SMS or email
        contact:
          type: string
          description: Email or phone number to send the OTP code to
    InitOtpResponse:
      required:
      - otpId
      type: object
      properties:
        otpId:
          type: string
          description: Unique identifier for an OTP authentication
    OAuth2AuthenticateRequest:
      required:
      - authCode
      - clientId
      - codeVerifier
      - provider
      - redirectUri
      type: object
      properties:
        provider:
          $ref: '#/components/schemas/Oauth2Provider'
        authCode:
          type: string
          description: The auth_code provided by the OAuth 2.0 to the end user to
            be exchanged for a Bearer token in the OAuth 2.0 flow
        redirectUri:
          type: string
          description: The URI the user is redirected to after they have authenticated
            with the OAuth 2.0 provider
        codeVerifier:
          type: string
          description: The code verifier used by OAuth 2.0 PKCE providers
        nonce:
          type: string
          description: An optional nonce used by the client to prevent replay/substitution
            of an ID token
          nullable: true
        clientId:
          type: string
          description: The client ID registered with the OAuth 2.0 provider
    OAuth2AuthenticateResponse:
      required:
      - oidcToken
      type: object
      properties:
        oidcToken:
          type: string
          description: A Turnkey issued OIDC token to be used with the LoginWithOAuth
            activity
    OAuthLoginRequest:
      required:
      - oidcToken
      - publicKey
      type: object
      properties:
        oidcToken:
          type: string
          description: Base64 encoded OIDC token
        publicKey:
          type: string
          description: "Client-side public key generated by the user, which will be\
            \ conditionally added to org data based on the validity of the oidc token\
            \ associated with this request"
        invalidateExisting:
          type: boolean
          description: Invalidate all other previously generated Login API keys
          nullable: true
        organizationId:
          type: string
          description: "Unique identifier for a given Organization. If provided, this\
            \ organization id will be used directly. If omitted, uses the OIDC token\
            \ to look up the associated organization id."
          nullable: true
    OAuthLoginResponse:
      required:
      - session
      type: object
      properties:
        session:
          type: string
          description: "Signed JWT containing an expiry, public key, session type,\
            \ user id, and organization id"
    Oauth2Provider:
      type: string
      enum:
      - OAUTH2_PROVIDER_X
      - OAUTH2_PROVIDER_DISCORD
    OauthProviderParams:
      required:
      - oidcToken
      - providerName
      type: object
      properties:
        providerName:
          type: string
          description: Human-readable name to identify a Provider.
        oidcToken:
          type: string
          description: Base64 encoded OIDC token
    OtpLoginRequest:
      required:
      - publicKey
      - verificationToken
      type: object
      properties:
        verificationToken:
          type: string
          description: "Signed JWT containing a unique id, expiry, verification type,\
            \ contact. Verification status of a user is updated when the token is\
            \ consumed (in OTP_LOGIN requests)"
        publicKey:
          type: string
          description: "Client-side public key generated by the user, which will be\
            \ conditionally added to org data based on the validity of the verification\
            \ token"
        invalidateExisting:
          type: boolean
          description: Invalidate all other previously generated Login API keys
          nullable: true
        organizationId:
          type: string
          description: "Unique identifier for a given Organization. If provided, this\
            \ organization id will be used directly. If omitted, uses the verification\
            \ token to look up the verified sub-organization based on the contact\
            \ and verification type."
          nullable: true
        clientSignature:
          type: string
          description: Optional signature associated with the public key passed into
            the verification step. This must be a hex-encoded ECDSA signature over
            the verification token. Only required if a public key was provided during
            the verification step.
          nullable: true
    OtpLoginResponse:
      required:
      - session
      type: object
      properties:
        session:
          type: string
          description: "Signed JWT containing an expiry, public key, session type,\
            \ user id, and organization id"
    PathFormat:
      type: string
      enum:
      - PATH_FORMAT_BIP32
    SignupRequest:
      required:
      - apiKeys
      - authenticators
      - oauthProviders
      type: object
      properties:
        userEmail:
          type: string
          nullable: true
        userPhoneNumber:
          type: string
          nullable: true
        userTag:
          type: string
          nullable: true
        userName:
          type: string
        organizationName:
          type: string
        verificationToken:
          type: string
          nullable: true
        apiKeys:
          type: array
          description: "A list of API Key parameters. This field, if not needed, should\
            \ be an empty array in your request body."
          items:
            $ref: '#/components/schemas/ApiKeyParamsV2'
        authenticators:
          type: array
          description: "A list of Authenticator parameters. This field, if not needed,\
            \ should be an empty array in your request body."
          items:
            $ref: '#/components/schemas/AuthenticatorParamsV2'
        oauthProviders:
          type: array
          description: "A list of Oauth providers. This field, if not needed, should\
            \ be an empty array in your request body."
          items:
            $ref: '#/components/schemas/OauthProviderParams'
        wallet:
          $ref: '#/components/schemas/WalletParams'
    SignupResponse:
      required:
      - organizationId
      - userId
      type: object
      properties:
        organizationId:
          type: string
        wallet:
          $ref: '#/components/schemas/WalletResult'
        userId:
          title: User ID
          type: string
          description: Root user ID created for this sub-organization
    VerifyOtpRequest:
      required:
      - otpCode
      - otpId
      type: object
      properties:
        otpId:
          type: string
          description: ID representing the result of an init OTP activity.
        otpCode:
          type: string
          description: OTP sent out to a user's contact (email or SMS)
        publicKey:
          type: string
          description: "Client-side public key generated by the user, which will be\
            \ added to the JWT response and verified in subsequent requests via a\
            \ client proof signature"
          nullable: true
    VerifyOtpResponse:
      required:
      - verificationToken
      type: object
      properties:
        verificationToken:
          type: string
          description: "Signed JWT containing a unique id, expiry, verification type,\
            \ contact. Verification status of a user is updated when the token is\
            \ consumed (in OTP_LOGIN requests)"
    WalletAccountParams:
      required:
      - addressFormat
      - curve
      - path
      - pathFormat
      type: object
      properties:
        curve:
          $ref: '#/components/schemas/Curve'
        pathFormat:
          $ref: '#/components/schemas/PathFormat'
        path:
          type: string
          description: Path used to generate a wallet Account.
        addressFormat:
          $ref: '#/components/schemas/AddressFormat'
    WalletParams:
      required:
      - accounts
      - walletName
      type: object
      properties:
        walletName:
          type: string
          description: Human-readable name for a Wallet.
        accounts:
          type: array
          description: "A list of wallet Accounts. This field, if not needed, should\
            \ be an empty array in your request body."
          items:
            $ref: '#/components/schemas/WalletAccountParams'
        mnemonicLength:
          type: integer
          description: "Length of mnemonic to generate the Wallet seed. Defaults to\
            \ 12. Accepted values: 12, 15, 18, 21, 24."
          format: int32
          nullable: true
    WalletResult:
      required:
      - addresses
      - walletId
      type: object
      properties:
        walletId:
          type: string
        addresses:
          type: array
          description: A list of account addresses.
          items:
            type: string
x-original-swagger-version: "2.0"
